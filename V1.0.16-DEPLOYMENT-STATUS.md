# v1.0.16 Deployment Status

**Date:** 2025-11-20
**Bug Fixed:** Bug #34 - Headers received but blocks never downloaded

---

## Deployment Complete ✓

### Code Changes
- **Commit:** `c38ef57`
- **Branch:** `main`
- **Pushed to GitHub:** ✓

### Seed Nodes Deployed
All three seed nodes successfully deployed with v1.0.16:

1. **NYC (134.122.4.164)** - ✓ DEPLOYED
   - Pulled commit c38ef57
   - Blockchain wiped (full reset)
   - Binary rebuilt
   - Service started

2. **Singapore (188.166.255.63)** - ✓ DEPLOYED
   - Pulled commit c38ef57
   - Blockchain wiped (full reset)
   - Binary rebuilt
   - Service started

3. **London (209.97.177.197)** - ✓ DEPLOYED
   - Pulled commit c38ef57
   - Blockchain wiped (full reset)
   - Binary rebuilt
   - Service started

---

## Bug #34 Fix Summary

**File Modified:** `src/node/dilithion-node.cpp` (lines 1479-1494)

**Fix:**
```cpp
// Bug #34 fix: Queue received blocks for download
// After headers are validated, tell BlockFetcher to download the actual blocks
if (g_block_fetcher) {
    // Calculate starting height for this batch of headers
    int startHeight = bestHeight - static_cast<int>(headers.size()) + 1;

    for (size_t i = 0; i < headers.size(); i++) {
        uint256 hash = headers[i].GetHash();
        int height = startHeight + static_cast<int>(i);

        g_block_fetcher->QueueBlockForDownload(hash, height);
        std::cout << "[IBD] Queued block " << hash.GetHex().substr(0, 16)
                  << "... (height " << height << ") for download" << std::endl;
    }
}
```

**Root Cause:**
- Headers were received and validated successfully
- HeadersManager stored them correctly
- BUT: BlockFetcher was never called to download the actual blocks
- Result: Nodes mined competing blocks instead of syncing

**Expected Behavior After Fix:**
1. Node receives headers from peers
2. Headers validated and stored
3. **NEW:** Blocks queued for download ← Bug #34 fix
4. Blocks downloaded and validated
5. Node syncs to network tip
6. ONLY THEN starts mining new blocks

---

## Testing Status

### IBD Testing - IN PROGRESS

Network reset complete, all nodes at genesis (height 0).

**Next Steps:**
1. Wait for NYC to mine 2-3 blocks (RandomX initializing on 4GB RAM)
2. Test local node IBD sync from seed nodes
3. Verify "[IBD] Queued block" messages appear in logs
4. Confirm blocks downloaded before mining starts

---

## Option B Network Reset Reasoning

Chose full network reset (Option B) over updating local genesis (Option A):

**Advantages:**
- Clean history with bug fixes already applied
- All nodes running same codebase
- Professional development practice
- Testnet data has no value
- Establishes good patterns for future

**Alternative (Option A - rejected):**
- Update local genesis to match seed nodes
- Quick hack, creates technical debt
- Inconsistent codebases across network

---

**Status:** Deployment complete, IBD testing in progress
